A = [0.415938799418954,-0.0447627463082313,-0.0156191449354559,-0.00868341730177341,-0.0241656569478950,-0.0115405257590929,-0.0171957881004795,-0.0195821822751796,-0.0345792409307061,-0.0118132697834690,-0.0130750079680589;-0.0447627463082313,0.296895075627550,-0.0177824445932304,-0.00828025343836800,-0.0241355567148878,0.00106957275352685,-0.0206514984914284,-0.0236362257656094,-0.0568275334740239,-0.0192020694327589,-0.0191518277543758;-0.0156191449354559,-0.0177824445932304,0.239225313583040,0.00731865296349710,0.0183029430661773,0.0325575711528338,0.00644921240606687,0.00711966623730478,-0.0159598634662310,-0.00505175012002337,-0.00161830860162864;-0.00868341730177341,-0.00828025343836799,0.00731865296349710,0.213596005442617,0.0160103072740607,0.0251271659650721,0.00656678442130545,0.00731328840433818,-0.00802809661048061,-0.00244859321291185,0.000206021481805737;-0.0241656569478950,-0.0241355567148878,0.0183029430661773,0.0160103072740607,0.253083374166837,0.0651501366364654,0.0162479651830960,0.0180713181146152,-0.0229163027791614,-0.00705907400034008,-0.000178478691640052;-0.0115405257590929,0.00106957275352685,0.0325575711528338,0.0251271659650721,0.0651501366364654,0.231932364593111,0.0311442224487512,0.0349466905843464,-0.00431799931932902,-0.000548087580403845,0.00858764207369291;-0.0171957881004795,-0.0206514984914284,0.00644921240606688,0.00656678442130545,0.0162479651830960,0.0311442224487512,0.246957757919400,0.00559432546616710,-0.0181358908943069,-0.00580240995409211,-0.00252120401800796;-0.0195821822751796,-0.0236362257656094,0.00711966623730479,0.00731328840433818,0.0180713181146152,0.0349466905843465,0.00559432546616710,0.249050408800522,-0.0207152217819646,-0.00663427244503684,-0.00295286230228106;-0.0345792409307061,-0.0568275334740239,-0.0159598634662310,-0.00802809661048061,-0.0229163027791614,-0.00431799931932902,-0.0181358908943069,-0.0207152217819646,0.344353838215256,-0.0150970918438434,-0.0156042682501555;-0.0118132697834690,-0.0192020694327589,-0.00505175012002336,-0.00244859321291185,-0.00705907400034008,-0.000548087580403848,-0.00580240995409211,-0.00663427244503684,-0.0150970918438434,0.372919298003192,-0.00518499124610258;-0.0130750079680589,-0.0191518277543758,-0.00161830860162864,0.000206021481805735,-0.000178478691640051,0.00858764207369293,-0.00252120401800796,-0.00295286230228105,-0.0156042682501555,-0.00518499124610258,0.302151841392825];
eigA = sort(eig(A));
m = (eigA(1) +eigA(10))/2;
B = A - m*eye(11,11);
eigB = sort(eig(B));
y(1,:) = [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
s(1,1) = dot(y(1,:), y(1,:));
x(1,:) = y(1,:)/norm(y(1,:));

for e = 1:12
    E = 10^(-e);
    ee(e) = E;
    k = 2;
    while true
        y(k,:) = B * x(k-1,:)';
        s(k,1) = dot(y(k,:), y(k,:));
        t(k,1) = dot(y(k,:), x(k-1,:));
        x(k,:) = y(k,:)/norm(y(k,:));
        eigenValues(k,1) = s(k,1)/t(k,1);
        eigenValuesA(k,1) = eigenValues(k,1) + m;
        if abs(eigenValues(k,1) - eigB(11)) < E 
            norm_mistake(e) = norm(eigenValues(k,1) - eigB(11));
            norm_Al(e) = norm(B * x(k,:)' -  x(k,:)' * eigenValues(k,1)); 
            k = k - 1;
            kk(e) = k;
            break
        else
            k = k + 1;
        end
    end
    
end

figure
subplot(2,1,1)
loglog(ee,norm_mistake,'r')
hold on
loglog(ee,norm_Al,'b','LineWidth',1.2)
legend('ошибка от точности','||Bx-lx|| от точности')
subplot(2,1,2)
semilogx(ee,kk)
legend('итерации от точxности')

   








